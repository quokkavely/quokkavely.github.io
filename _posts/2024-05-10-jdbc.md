<!-- ---
layout : single
title : "[SQL] JDBC ë° ì‹¤ìŠµ"
categories: Database
tag : [DBMS, SQL, ì‹¤ìŠµ]
author_profile: true
---
ğŸ“Œ ê°œì¸ì ì¸ ê³µê°„ìœ¼ë¡œ ê³µë¶€ë¥¼ ê¸°ë¡í•˜ê³  ë³µìŠµí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. <br>
ì •í™•í•˜ì§€ ì•Šì€ ì •ë³´ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ì°¸ê³ ë°”ëë‹ˆë‹¤ :ğŸ˜¸ <br>
[í‹€ë¦° ë‚´ìš©ì€ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì‹œë©´ ë³µë°›ìœ¼ì‹¤ê±°ì—ìš”]  
{: .notice--primary}

ìƒˆë¡œ ì•Œê²Œ ëœ ê²ƒ : [TIMESTAMP](https://www.notion.so/SQL-JDBC-8b32c44fa61a4799bf492a2bc02651a2?pvs=21), PreparedStatement  

# JDBC

## JDBCë€?

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled.png)

1. JDBC APIëŠ” Java ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•˜ì—¬ ìì›ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” í‘œì¤€ API
2. ì–´í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œê°€ DB ë²¤ë”(Mysql, oracle, PostgreSQL ë“±...)ì— ì¢…ì†ë˜ì§€ ì•Šë„ë¡ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•¨ > ì¶”ìƒí™”ë˜ì–´ìˆìŒ
3. ë²¤ë”ì— ë”°ë¼ JDBC êµ¬í˜„ì²´ê°€ ì¡´ì¬í•˜ê³ , ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œìëŠ” ì´ë¥¼ ì´ìš©í•´ì„œ ë‹¤ì–‘í•œ ë²¤ë”ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŒ

## JDBC ì—°ê²° ê³¼ì •

1. JDBC ë“œë¼ì´ë²„ë¥¼ ë¡œë“œí•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•  ì¤€ë¹„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
2. ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°ì„ ì‹œì‘í•©ë‹ˆë‹¤. **ì»¤ë„¥ì…˜([Connection](https://docs.oracle.com/en/java/javase/11/docs/api/java.sql/java/sql/Connection.html))ê°ì²´ë¥¼ í• ë‹¹ ë°›ìŒ**
3. ì¿¼ë¦¬ë¬¸ì„ ì‹¤í–‰ í•˜ê¸° ìœ„í•´ì„œ Query ìˆ˜í–‰ ê°ì²´([Statement](https://docs.oracle.com/en/java/javase/11/docs/api/java.sql/java/sql/Statement.html))ë¥¼ ìƒì„±
4. Statementë¥¼ í†µí•´ Queryê°€ ìˆ˜í–‰
5. SELECTì™€ ê°™ì´ ì¡°íšŒë¬¸ì¼ ê²½ìš° ê²°ê³¼ë¥¼ ë°›ëŠ” ([ResultSet](https://docs.oracle.com/en/java/javase/11/docs/api/java.sql/java/sql/ResultSet.html))ê°ì²´ì— ê²°ê³¼ë¥¼ í• ë‹¹ 
6. ì‚¬ìš©í•œ ìì›ì„ ì •ë¦¬í•©ë‹ˆë‹¤. ResultSetì„ ë‹«ê³ , Statementë¥¼ ë‹«ê³ , Connectionì„ í•´ì œ

## JDBC API í´ë˜ìŠ¤

JDBCëŠ” ë‹¤ì–‘í•œ í´ë˜ìŠ¤ì™€ ì¸í„°í˜ì´ìŠ¤ë¡œ êµ¬ì„±ëœ íŒ¨í‚¤ì§€ java.sqlì™€ javax.sqlë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.

- ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•˜ì—¬ í…Œì´ë¸” í˜•íƒœì˜ ìë£Œë¥¼ ì°¸ì¡°
- SQL ë¬¸ì„ ì§ˆì˜
- SQL ë¬¸ì˜ ê²°ê³¼ë¥¼ ì²˜ë¦¬

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%201.png)

### **JDBC ì‚¬ìš©ê°ì²´**

| DriverManager | JDBC ë“œë¼ì´ë²„ë¥¼ í†µí•´ì„œ ì»¤ë„¥ì…˜ì„ ë§Œë“œëŠ” ì—­í• Class.forName() ë©”ì†Œë“œë¥¼ í†µí•´ ìƒì„±, ì˜ˆì™¸ì²˜ë¦¬ í•„ìˆ˜getConnection()ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ Connectionê°ì²´ë¥¼ ë°˜í™˜ë°›ìŒ |
| --- | --- |
| Connection | íŠ¹ì • ë°ì´í„° ì›ë³¸ê³¼ ì—°ê²°ëœ ê°ì²´DBì˜ ì—°ê²°ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´ Â  (ipì£¼ì†Œ,Â portë²ˆí˜¸,Â ê³„ì •ëª…,Â ë¹„ë°€ë²ˆí˜¸) |
| Statement | í•´ë‹¹ DBì— SQLë¬¸ì„ ì „ë‹¬í•˜ê³  ì‹¤í–‰í•œ í›„ ê²°ê³¼ë¥¼ ë°›ì•„ë‚´ëŠ” ê°ì²´Â Â  Â --> íŠ¹ì§•: ì™„ì„±ëœ SQLë¬¸ì„ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ê°ì²´ì„Â Â Connectionê°ì²´ì—Â ì˜í•´Â í”„ë¡œê·¸ë¨ì—Â êµ¬í˜„ë˜ëŠ”Â ì¼ì¢…ì˜Â ë©”ì†Œë“œÂ ì§‘í•©Â Â  Connectioní´ë˜ìŠ¤ì˜ createStatement()ë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ì²´ ìƒì„±Â  Statementê°ì²´ë¡œ SQLë¬¸ì„ Stringê°ì²´ë¡œ ë‹´ì•„ ì¸ìê°’ìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ ì§ˆì˜ ìˆ˜í–‰ |
| Result Set | SELECTë¬¸ì„Â ì‚¬ìš©í•œÂ ì§ˆì˜Â ì„±ê³µì‹œÂ ë°˜í™˜ë˜ëŠ”Â ê°ì²´(ë§Œì¼ ì‹¤í–‰í•œ SQLë¬¸ì´ SELECTë¬¸ì¼ ê²½ìš° ì¡°íšŒëœ ê²°ê³¼ê°€ result setê°ì²´ì— ë“¤ì–´ê°)SQL ì§ˆì˜ì— í•´ë‹¹í•˜ëŠ” ê²°ê³¼ë¥¼ ë‹´ê³  ìˆìœ¼ë©° 'ì»¤ì„œ(CURSOR)'ë¥¼ ì´ìš©í•˜ì—¬Â Â íŠ¹ì • í–‰ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ì¡°ì‘ |

## **JDBCë¥¼ ì´ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ê³¼ì •**

![á„ƒá…¡á„‹á…®á†«á„…á…©á„ƒá…³ (3).png](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/%25E1%2584%2583%25E1%2585%25A1%25E1%2584%258B%25E1%2585%25AE%25E1%2586%25AB%25E1%2584%2585%25E1%2585%25A9%25E1%2584%2583%25E1%2585%25B3_(3).png)

### 1.  JDBC ë“œë¼ì´ë²„ ë¡œë“œ

```java
Class.forName("com.mysql.Jdbc.Driver");
```

Class.forName()Â ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬, mysqlì—ì„œ ì œê³µí•˜ëŠ” Driver í´ë˜ìŠ¤ë¥¼ JVM method areaì— ë¡œë”©ì‹œí‚¨ë‹¤.

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°

```java
StringÂ jdbc_urlÂ =Â "jdbc:mysql://localhost:3306/datebase?serverTimezone=UTC";
Connection con =Â DriverManager.getConnection(URL,Â "user",Â "password");
```

- url ì˜ localhost:3306 (ë¡œì»¬ í™˜ê²½ì—ì„œ MySQLì˜ í¬íŠ¸ë²ˆí˜¸ê°€ 3306ì´ê¸° ë•Œë¬¸), ê·¸ë¦¬ê³  databaseëŠ” ìŠ¤í‚¤ë§ˆ ì´ë¦„ì„ ì§€ì •í•˜ë©´ ë¨
- ì´ì œ Connection ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ”ë° ë°©ë²•ì€ DriverManagerÂ í´ë˜ìŠ¤ì˜ static ë©”ì„œë“œì¸Â **getConnection()**Â ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì„œ, mysqlì— ì—°ê²°í•˜ê¸° ìœ„í•œ ì»¤ë„¥ì…˜ ì •ë³´(url, user, password)ë¥¼ ì…ë ¥í•œë‹¤.
- getConnection()Â ë©”ì„œë“œ ìˆ˜í–‰ ê²°ê³¼ë¡œÂ **Connection**Â ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ”ë°, ì´Â ê°ì²´ë¥¼ í†µí•´Â ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ëŠ”Â statementë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.Â Â **SELECT ì¿¼ë¦¬ì—ì„œëŠ”**Â **`createStatement()`**,  **INSERTì—ì„œëŠ”**Â **`prepareStatement()`**ë¥¼ í˜¸ì¶œí•œë‹¤.

### 3. SQLì„ ìœ„í•œ ê°ì²´ìƒì„±

```java
Statement stmt =Â con.createStatement();
```

### 4. SQL ë¬¸ì¥ ì‹¤í–‰

```java
StringÂ sqlÂ =Â "selectÂ *Â fromÂ student";
ResultSet result =Â stmt.executeQuery(sql);
```

select ë¬¸ì¥ì€ í…Œì´ë¸” í˜•íƒœì˜ ê²°ê³¼ë¥¼ ë°˜í™˜. 

ê·¸ëŸ¬ë¯€ë¡œ select ë¬¸ì¥ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ Statementì˜ ë©”ì†Œë“œÂ **executeQuery()**ë¥¼ ì‚¬ìš©í•œë‹¤. 

ë©”ì†Œë“œ executeQuery()ëŠ” ì§ˆì˜ ê²°ê³¼ë¡œ í…Œì´ë¸” í˜•íƒœì˜ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ”ë°, ì´ ë°˜í™˜í˜•ì´ ì¸í„°í˜ì´ìŠ¤ ResultSetì´ë‹¤.

ê°ì²´ Statementì˜ ë©”ì†Œë“œÂ `**executeUpdate()**ëŠ” create ë˜ëŠ” drop, insert, delete, updateì™€ ê°™ì´ í…Œì´ë¸”ì˜ ë‚´ìš©ì„ ë³€ê²½í•˜ëŠ” ë¬¸ì¥ì— ì‚¬ìš©`í•œë‹¤.

## ê¸°ì´ˆì‹¤ìŠµ ë° ì˜ˆì œ

### ì‹¤ìŠµ 1. Create Database

```sql
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class Main {
    public static void main(String[] args) {

        try {
            String URL = "jdbc:mysql://127.0.0.1:3306";
            String user = "root";
            String password = "!cjftn&dudgml617";
            Connection conn = DriverManager.getConnection(URL, user, password);
            Statement stmt = conn.createStatement();

            **String sql ="CREATE DATABASE IF NOT EXISTS testDatabase";
            stmt.execute(sql);**
            System.out.println("ë°ì´í„° ë² ì´ìŠ¤ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
        } catch (SQLException e){
            e.printStackTrace();
        }
    }
}
```

### ì‹¤ìŠµ 2. Create table

```sql
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class CreateTables {
    public static void main(String[] args) {

        try {
            String URL = "jdbc:mysql://127.0.0.1:3306/testdatabase";
            String user = "root";
            String password = "!cjftn&dudgml617";
            Connection conn = DriverManager.getConnection(URL, user, password);
            Statement stmt = conn.createStatement();

            String sql ="CREATE TABLE IF NOT EXISTS Board ( " +
                    "id INT AUTO_INCREMENT PRIMARY KEY , " +
                    "title VARCHAR(255)  NOT NULL , " +
                    "body TEXT NOT NULL)";
            **stmt.executeUpdate(sql);**
            System.out.println("í…Œì´ë¸”ì„  ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");

        sql = "CREATE TABLE IF NOT EXISTS Member (" +
                "id INT AUTO_INCREMENT PRIMARY KEY, " +
                "name VARCHAR(255) NOT NULL, " +
                "email VARCHAR(255) NOT NULL UNIQUE, " +
                "board_id INT, " +
                "FOREIGN KEY (board_id) REFERENCES Board(id))";
        **stmt.executeUpdate(sql);**
            System.out.println("Member í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
            stmt.close();
            conn.close();

        } catch (SQLException e){
            e.printStackTrace();
        }
    }
}
```

### ì‹¤ìŠµ 3. Insert

```sql
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class InsertintoExample {
    public static void main(String[] args) {

        try {
            String URL = "jdbc:mysql://127.0.0.1:3306/testdatabase";
            String user = "root";
            String password = "!cjftn&dudgml617";
            Connection conn = DriverManager.getConnection(URL, user, password);
            Statement stmt = conn.createStatement();

            String sql = "INSERT INTO Board (title, body) VALUES " +
                    "('JAVA í”„ë¡œê·¸ë˜ë°', 'JAVA í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•œ ê¸°ì´ˆ' ), " +
                    "('ë°ì´í„°ë² ì´ìŠ¤ì˜ ê¸°ì´ˆ', 'SQL ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬' ) ";
            int boardRows= stmt.executeUpdate(sql);
            System.out.println(boardRows+"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
            sql = "INSERT INTO Member (name, email, board_id) VALUES " +
                    "('ë°•í˜œì§€', 'jerry@gmail.com', 1), " +
                    "('ê¹€ëŸ¬í‚¤', 'lucky @naver.com', 2 )";

            stmt.executeUpdate(sql);

            stmt.close();
            conn.close();

        } catch (
                SQLException e) {
            e.printStackTrace();
        }
    }
}

```

# JDBC ì‹¤ìŠµ - Instagram

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%202.png)

ERDë³´ê³  í…Œì´ë¸” ìƒì„±

### ë°”ë¡œê°€ê¸°

[Connection, Statementê°ì²´ìƒì„±, Example class](https://www.notion.so/Connection-Statement-Example-class-37d9b3508a0b40c894e6821af56d613a?pvs=21) / [Create table](https://www.notion.so/Create-table-22a6c2de14634de0a135ac6e269b7513?pvs=21) / [Insert DermyData](https://www.notion.so/SQL-JDBC-8b32c44fa61a4799bf492a2bc02651a2?pvs=21) / [ì¡°íšŒê´€ë ¨ë¬¸ì œ 1-9ë²ˆ](https://www.notion.so/SQL-JDBC-8b32c44fa61a4799bf492a2bc02651a2?pvs=21) / [ì‚½ì…,ìˆ˜ì •,ì‚­ì œ ë“± ê´€ë ¨ë¬¸ì œ 10-17ë²ˆ](https://www.notion.so/SQL-JDBC-8b32c44fa61a4799bf492a2bc02651a2?pvs=21)

1. Connection, Statementê°ì²´ìƒì„±, Example class
    
    ê°ì²´ ìƒì„±ë¶€ë¶„ì„ ë”°ë¡œ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©
    
    ```sql
    import java.sql.*;
    
    public class Example {
        private String URL;
        private String user;
        private  String password;
        private Connection conn;
        private Statement stmt;
    
        public Example() throws SQLException {
            this.URL = "jdbc:mysql://127.0.0.1:3306/instagram";
            this.user = "root";
            this.password = "!cjftn&dudgml617";
            this.conn = DriverManager.getConnection(URL, user, password);
            this.stmt = conn.createStatement();
        }
    
        public Connection getConn() {
            return conn;
        }
    
        public Statement getStmt() {
            return stmt;
        }
    }
    ```
    

1. Create table
    
    ```sql
    import java.sql.Connection;
    import java.sql.DriverManager;
    import java.sql.SQLException;
    import java.sql.Statement;
    
    public class Create {
        public static void main(String[] args) {
    
        try {
                    Example ex = new Example();
            String sql ="CREATE TABLE IF NOT EXISTS Users ( " +
                    "id INT AUTO_INCREMENT PRIMARY KEY , " +
                    "userName VARCHAR(50)  NOT NULL , " +
                    "password VARCHAR(50) NOT NULL)";
                    ex.getStmt().executeUpdate(sql);
            System.out.println("Users í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
            sql = "CREATE TABLE IF NOT EXISTS Posts (" +
                    "id INT AUTO_INCREMENT PRIMARY KEY, " +
                    "image BLOB, " +
                    "message TEXT, " +
                    "created_at DATETIME, " +
                    "total_likes INT, " +
                    "total_comments INT, " +
                    "user_id INT, " +
                    "FOREIGN KEY (user_id) REFERENCES Users(id))";
            ex.getStmt().executeUpdate(sql);
            System.out.println("Posts í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
    
            sql="CREATE TABLE IF NOT EXISTS Post_comments("  +
                    "id INT AUTO_INCREMENT PRIMARY KEY, " +
                    "comment VARCHAR(255), " +
                    "created_at DATETIME, " +
                    "user_id INT, " +
                    "post_id INT, " +
                    "FOREIGN KEY (user_id) REFERENCES Users(id), " +
                    "FOREIGN KEY (post_id) REFERENCES Posts(id)) ";
            ex.getStmt().executeUpdate(sql);
            System.out.println("Post_comments í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
    
            sql= "CREATE TABLE IF NOT EXISTS Post_likes( " +
                    "id INT AUTO_INCREMENT PRIMARY KEY, " +
                    "created_at DATETIME, " +
                    "user_id INT, " +
                    "post_id INT, " +
                    "FOREIGN KEY(user_id) REFERENCES Users(id), " +
                    "FOREIGN KEY(post_id) REFERENCES Posts(id))";
            ex.getStmt().executeUpdate(sql);
            System.out.println("Post_likes í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
    
            sql="CREATE TABLE IF NOT EXISTS Hashtags( " +
                    "id INT AUTO_INCREMENT PRIMARY KEY, " +
                    "name CHAR(50))";
            ex.getStmt().executeUpdate(sql);
            System.out.println("Hashtags í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
    
            sql = "CREATE TABLE IF NOT EXISTS Posts_hashtags( " +
                    "id INT AUTO_INCREMENT PRIMARY KEY, " +
                    "hashtag_id INT, " +
                    "post_id INT, " +
                    "FOREIGN KEY (hashtag_id) REFERENCES Hashtags(id), " +
                    "FOREIGN KEY (post_id) REFERENCES Posts(id)) ";
            ex.getStmt().executeUpdate(sql);
            System.out.println("Posts_hashtags í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
    
            sql="CREATE TABLE IF NOT EXISTS Follow_follower( " +
                    "id INT AUTO_INCREMENT PRIMARY KEY, " +
                    "follow_id INT," +
                    "user_id INT," +
                    "FOREIGN KEY (follow_id) REFERENCES Follow_follower(id), " +
                    "FOREIGN KEY (user_id) REFERENCES Users(id))";
            ex.getStmt().executeUpdate(sql);
            System.out.println("Follow_follower í…Œì´ë¸”ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.");
    
            ex.getStmt().close();
    	      ex.getConn().close();
    
        } catch (SQLException e){
            e.printStackTrace();
        }
    }
    }
    
    ```
    
2. INSERT
    
    ```sql
    
    import java.sql.SQLException;
    
    public class INSERT {
        public static void main(String[] args) {
            try {
               Example ex = new Example();
                String sqlInsertUsers = "INSERT INTO users (username, password) VALUES " +
                        "('user1', 'password1'), ('user2', 'password2'), ('user3', 'password3'), " +
                        "('user4', 'password4'), ('user5', 'password5'), ('user6', 'password6'), " +
                        "('user7', 'password7'), ('user8', 'password8'), ('user9', 'password9'), " +
                        "('user10', 'password10')";
                int usersRows = ex.getStmt().executeUpdate(sqlInsertUsers);
                System.out.println(usersRows+"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                String sqlInsertPosts = "INSERT INTO posts (image, message, user_id) VALUES " +
                        "(NULL, 'Hello World', 1), (NULL, 'Learning Java', 2), " +
                        "(NULL, 'At the beach', 3), (NULL, 'Eating pizza', 4), " +
                        "(NULL, 'Watching a movie', 5), (NULL, 'At a concert', 6), " +
                        "(NULL, 'Playing games', 7), (NULL, 'Reading a book', 8), " +
                        "(NULL, 'Visiting museums', 9), (NULL, 'Going hiking', 10)";
                int sqlInsertPostsRows = ex.getStmt().executeUpdate(sqlInsertPosts );
                System.out.println(sqlInsertPostsRows +"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                String sqlInsertComments = "INSERT INTO post_comments (comment, user_id, post_id) VALUES " +
                        "('Nice post!', 1, 1), ('Love this!', 2, 1), ('So cool!', 3, 2), " +
                        "('Wow!', 4, 3), ('Great pic!', 5, 3), ('Can''t agree more!', 6, 4), " +
                        "('LOL', 7, 5), ('That''s awesome!', 8, 6), ('Yummy!', 9, 7), ('Interesting!', 10, 8)";
                int sqlInsertCommentsRows = ex.getStmt().executeUpdate(sqlInsertComments);
                System.out.println(sqlInsertCommentsRows +"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                String sqlInsertLikes = "INSERT INTO post_likes (user_id, post_id) VALUES " +
                        "(1, 1), (2, 1), (3, 1), (4, 2), (5, 2), " +
                        "(6, 3), (7, 3), (8, 4), (9, 5), (10, 5)";
    
                int sqlInsertLikesRows = ex.getStmt().executeUpdate(sqlInsertLikes );
                System.out.println(sqlInsertLikesRows +"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                String sqlInsertFollows = "INSERT INTO follow_follower (follower_id, user_id) VALUES " +
                        "(1, 2), (1, 3), (2, 3), (2, 4), (3, 4), " +
                        "(3, 5), (4, 5), (4, 6), (5, 6), (5, 7)";
                int sqlInsertFollowsRows = ex.getStmt().executeUpdate(sqlInsertFollows );
                System.out.println(sqlInsertFollowsRows +"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                String sqlInsertHashtags = "INSERT INTO hashtags (name) VALUES " +
                        "('summer'), ('java'), ('beach'), ('pizza'), ('movie'), " +
                        "('concert'), ('games'), ('book'), ('museum'), ('hiking')";
    
                int sqlInsertHashtagsRows = ex.getStmt().executeUpdate(sqlInsertHashtags );
                System.out.println(sqlInsertHashtagsRows +"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                String sqlInsertPostsHashtags = "INSERT INTO posts_hashtags (hashtag_id, post_id) VALUES " +
                        "(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), " +
                        "(6, 6), (7, 7), (8, 8), (9, 9), (10, 10)";
    
                int sqlInsertPostsHashtagsRows = ex.getStmt().executeUpdate(sqlInsertPostsHashtags );
                System.out.println(sqlInsertPostsHashtagsRows +"ê°œì˜ ê¸€ì´ í…Œì´ë¸”ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");
    
                ex.getStmt().close();
                ex.getConn().close();
    
            } catch (SQLException e){
                e.printStackTrace();
            }
        }
    }
    
    ```
    
3. SELECTION
    
    
    ```sql
    import java.sql.*;
    
    public class Selection {
        public static void main(String[] args) {
    
            try {
                Example ex = new Example();
                String result ="SELECT  userName from users ";
                ResultSet rsResult=ex.getStmt().executeQuery(result);
                System.out.println("-".repeat(40));
                System.out.println("ë¬¸ì œ 1");
                while(rsResult.next()){
                    System.out.println(rsResult.getString("userName"));
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result = "SELECT message,created_at FROM Posts ";
                rsResult = ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 2");
                while(rsResult.next()){
                    System.out.println("message: "+rsResult.getString("message")+",
                     created_at : "+rsResult.getString("created_at"));
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result="SELECT u.userName from Users u JOIN posts p " +
                        "ON p.user_id = u.id WHERE p.id>=1 ";
                rsResult=ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 3");
                while(rsResult.next()){
                    System.out.println("ì‚¬ìš©ì ì´ë¦„ :"+rsResult.getString("userName") );
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result ="SELECT message FROM posts p 
                WHERE created_at >=  DATE_ADD( NOW(), INTERVAL -1 DAY)";
                
                rsResult =ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 4");
                while(rsResult.next()){
                    System.out.println("message :" + rsResult.getString("message"));
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
           result ="SELECT u.userName, COUNT(p.id) from users u JOIN posts p ON p.user_id = u.id GROUP BY u.userName; ";
          rsResult = ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 5");
                while(rsResult.next()){
                    System.out.println( "ì‚¬ìš©ì ì´ë¦„ : "+rsResult.getString("userName")+" ,
                     ê²Œì‹œê¸€ ìˆ˜ :" + rsResult.getString("COUNT(p.id)"));
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result = "SELECT message FROM posts WHERE message like '%;like%'";
                rsResult=ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 6");
                while(rsResult.next()){
                    System.out.println("like in message :" + rsResult.getString("message") );
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result="SELECT p.message,count(pl.post_id) as conutlike 
                FROM posts p " +
                        "JOIN post_likes pl ON pl.post_id=p.id 
                        group by post_id having conutlike >=5";
                rsResult =ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 7");
                while(rsResult.next()){
                    System.out.println("like 5 in message :" + rsResult.getString("message") );
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result ="SELECT p.id as post_id, COUNT(pc.id)as commentNumber 
                FROM post_comments pc " +
                        "JOIN posts p ON pc.post_id = p.id group by p.id";
                rsResult =ex.getStmt().executeQuery(result);
                System.out.println("ë¬¸ì œ 8");
                while (rsResult.next()){
                    System.out.println("post_id : "+rsResult.getString("post_id")+" , comment count : " +rsResult.getString("commentNumber"));
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                result="SELECT u.userName,count(ff.follower_id)as follower_number FROM Users u JOIN follow_follower ff ON ff.user_id = u.id " +
                        "group by userName " +
                        "having follower_number = (select max(followerCnt) from (select u2.userName,count(ff2.follower_id)as followerCnt from users u2 " +
                        "join follow_follower ff2 on ff2.user_id = u2.id " +
                        "group by u2.userName)as sub);";
                System.out.println("ë¬¸ì œ 9");
                rsResult= ex.getStmt().executeQuery(result);
                while(rsResult.next()){
                    System.out.println("ê°€ì¥ ë§ì€ íŒ”ë¡œì›Œ ìˆ˜ë¥¼ ê°€ì§€ëŠ” ì‚¬ìš©ì ì´ë¦„ : " +rsResult.getString("u.userName") + ",  íŒ”ë¡œì›Œ ìˆ˜  :" +rsResult.getString("follower_number"));
                }
                System.out.println("-".repeat(40));
                rsResult.close();
    
                ex.getStmt().close();
                ex.getConn().close();
    
            } catch (SQLException e) {
                e.printStackTrace();
            }
    
            }
        }
    
    ```
    
    1. ë¬¸ì œ 1
        1. ê°•ì‚¬ë‹˜ì½”ë“œ
            
            ```sql
            
                    String SQL = "SELECT username, password FROM Users";
                    ResultSet rs = statement.executeQuery(SQL);
            
                    while(rs.next()) {
                        System.out.println(rs.getString("username") + " " +
                                rs.getString("password"));
                    }
                }
            }
            ```
            
    2. ë¬¸ì œ 2
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
            
            ```sql
                String SQL = "SELECT message, created_at FROM Posts";
                    ResultSet rs = statement.executeQuery(SQL);
            
                    while(rs.next()) {
                        System.out.println(rs.getString("message") + " " +
                                rs.getString("created_at"));
                                }
            ```
            
    3. ë¬¸ì œ 3
        1. ê°•ì‚¬ë‹˜ì½”ë“œ
            
            ```sql
             String SQL = 
             "select **distinct** u.username from users u " +
                                "join posts p " +
                                "on u.id = p.user_id ";
                        ResultSet rs = statement.executeQuery(SQL);
            
                        while(rs.next()) {
                            System.out.println(rs.getString("username"));
            ```
            
            **`userNameì— ì¤‘ë³µì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ DISTINCT ì ì–´ì„œ ì¤‘ ì œê±°í•´ì£¼ì–´ì•¼ í•¨.`** 
            
    4. ë¬¸ì œ 4
        1. ê°•ì‚¬ë‹˜ ì½”ë“œâœ”ï¸âœ”ï¸
            
            ```sql
             String SQL = "SELECT message FROM Posts " +
            "WHERE created_at >= CURRENT_TIMESTAMP - INTERVAL 1 DAY";
               ResultSet rs = statement.executeQuery(SQL);
               //        rs.last();
            //        int length = rs.getRow();
            //        rs.beforeFirst();
            //        System.out.println(length);
                    int count = 0;
                    while(rs.next()) {
                        System.out.println(rs.getString("message"));
                        count++;
                    }
            
                    System.out.println(count);
                }
            }
            ```
            
    5. ë¬¸ì œ 5
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
            
            ```sql
                String SQL = 
                "SELECT u.username as username , COUNT(p.id) AS post_count " +
                            "FROM Users as u " +
                            "left join Posts as p ON u.id = p.user_id " +
                            "GROUP BY u.username";
                    ResultSet rs = statement.executeQuery(SQL);
            
                    while(rs.next()) {
                        System.out.println(rs.getString("username") + " " +
                                rs.getString("post_count"));
                    }
            ```
            
            ê²Œì‹œê¸€ ìˆ˜ ê°€ 0ì¸ userë„ ì¡°íšŒí•´ì•¼ í•˜ë¯€ë¡œ Outer join í•´ì•¼ë¨
            
    6. ë¬¸ì œ 6
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
            
            ```sql
              String SQL = "SELECT message FROM Posts " +
                            "WHERE message LIKE '%like%'";
                    ResultSet rs = statement.executeQuery(SQL);
            
                    while(rs.next()) {
                        System.out.println(rs.getString("message"));
                    }
            ```
            
    
    1. ë¬¸ì œ 7
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
            
            ```sql
            String SQL = 
            "SELECT p.id as id, count(pl.id) as count from Posts as p " +
                            "join post_likes as pl " +
                            "on pl.post_id = p.id " +
                            "group by p.id " +
                            "having count >= 5";
                    ResultSet rs = statement.executeQuery(SQL);
            
                    while(rs.next()) {
                        System.out.println(rs.getString("id") + " " + rs.getInt("count"));
                    }
            ```
            
    2. ë¬¸ì œ 8
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
            
            ```sql
            
            ```
            
        2. Outer join ì‚¬ìš©í•´ì•¼ í•¨, ëŒ“ê¸€ì´ ì—†ëŠ” postsë„ Count í•´ì•¼í•˜ë¯€ë¡œ
        
    3. ë¬¸ì œ 9
        1. ê°•ì‚¬ë‹˜ì½”ë“œ
            
            ```sql
               String SQL = 
               "select ff.follower_id , count(*) " +
             "from follow_follower ff " +
             "group by ff.follower_id " +
               "having count(*) = (select MAX(cnt) from ( " +
              "select count(*) as cnt " +
                 "from follow_follower ff " +
                 "group by ff.follower_id " +
                            ") as sq)";
                    ResultSet rs = statement.executeQuery(SQL);
            
                    while(rs.next()) {
                        System.out.println(rs.getString("ff.follower_id") + " " + rs.getInt("count(*)"));
                    }
            ```
            
4. UPDATE&DELETE&INSERT
    
    
    1. ë¬¸ì œ 10ë²ˆ~ 17ë²ˆê¹Œì§€
    
    ```sql
    
    import java.sql.SQLException;
    
    public class Update {
        public static void main(String[] args) {
            try {
                Example ex=new Example();
    
                String ten= "UPDATE Users SET userName = 'newUser1' 
                WHERE userName='user1'";
                int updateRows = ex.getStmt().executeUpdate(ten);
                System.out.println("ë¬¸ì œ 10");
                System.out.println(updateRows+"ê°œì˜ ì‚¬ìš©ì ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
                String eleven="INSERT INTO post_likes (user_id, post_id) " +
                        "SELECT user_id, 3 FROM post_likes  WHERE id <= 5;";
    
                updateRows =  ex.getStmt().executeUpdate(eleven);
                System.out.println("ë¬¸ì œ 11");
                System.out.println(updateRows+"ê°œì˜ ì¢‹ì•„ìš” ìˆ˜ê°€ ì¦ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
                String twelve="UPDATE Posts p JOIN Users u ON u.id = p.user_id SET message = CONCAT(message,'-updated') WHERE u.id=2";
                updateRows = ex.getStmt().executeUpdate(twelve);
                System.out.println("ë¬¸ì œ 12");
                System.out.println(updateRows+"ê°œì˜ ê²Œì‹œê¸€ ìˆ˜ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
                String thirteen="UPDATE posts p " +
                        "join users u on p.user_id =u.id " +
                        "SET message ='hello world' " +
                        "WHERE u.id = 4;";
                updateRows= ex.getStmt().executeUpdate(thirteen);
                System.out.println("ë¬¸ì œ 13,14");
                System.out.println(updateRows+"ê°œì˜ messageê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
                String fifteen=
                "UPDATE Posts SET created_at = NOW() WHERE id = 1" ;
                updateRows= ex.getStmt().executeUpdate(fifteen);
                System.out.println("ë¬¸ì œ15");
                System.out.println(updateRows+"ê°œì˜ ê²Œì‹œê¸€ì˜ ìƒì„±ë‚ ì§œê°€  ì˜¤ëŠ˜ë‚ ì§œë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
              /* String seventeen0="ALTER TABLE follow_follower DROP FOREIGN KEY follow_follower_ibfk_2;";
                stmt.executeUpdate(seventeen1);
                seventeen0= "ALTER TABLE follow_follower ADD CONSTRAINT follow_follower_ibfk_2 FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ";
             stmt.executeUpdate(seventeen1);
                seventeen0="ALTER TABLE post_likes DROP FOREIGN KEY post_likes_ibfk_1";
                stmt.executeUpdate(seventeen1);
                seventeen0= "ALTER TABLE post_likes ADD CONSTRAINT post_likes_ibfk_1 FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ";
                stmt.executeUpdate(seventeen1);
                seventeen0="ALTER TABLE posts DROP FOREIGN KEY posts_ibfk_1;";
                stmt.executeUpdate(seventeen1);
    
                String seventeen1 = "ALTER TABLE posts ADD CONSTRAINT posts_ibfk_1 FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ";
                stmt.executeUpdate(seventeen1);
                seventeen1="ALTER TABLE post_comments DROP FOREIGN KEY post_comments_ibfk_1;";
                stmt.executeUpdate(seventeen1);
                seventeen1= "ALTER TABLE post_comments ADD CONSTRAINT post_comments_ibfk_1 FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ";
                stmt.executeUpdate(seventeen1);
    
                String seventeen2="ALTER TABLE posts_hashtags DROP FOREIGN KEY posts_hashtags_ibfk_2;";
                stmt.executeUpdate(seventeen2);
                seventeen2="ALTER TABLE posts_hashtags ADD CONSTRAINT posts_hashtags_ibfk_2 FOREIGN KEY (post_id) REFERENCES posts(id) ON DELETE CASCADE";
                stmt.executeUpdate(seventeen2);
    */
    
                String seventeen ="DELETE FROM Users WHERE id =10";
                int deleteRows= ex.getStmt().executeUpdate(seventeen);
                System.out.println("ë¬¸ì œ17");
                System.out.println(deleteRows+"ê°œì˜ ì‚¬ìš©ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
                String seventeen3="ALTER TABLE post_comments DROP FOREIGN KEY post_comments_ibfk_2;";
                ex.getStmt().executeUpdate(seventeen3);
                seventeen3="ALTER TABLE post_comments ADD CONSTRAINT post_comments_ibfk_2 FOREIGN KEY (post_id) REFERENCES posts(id) ON DELETE CASCADE";
                ex.getStmt().executeUpdate(seventeen3);
                seventeen3="ALTER TABLE post_likes DROP FOREIGN KEY post_likes_ibfk_2;";
                ex.getStmt().executeUpdate(seventeen3);
                seventeen3="ALTER TABLE post_likes ADD CONSTRAINT post_likes_ibfk_2 FOREIGN KEY (post_id) REFERENCES posts(id) ON DELETE CASCADE";
                ex.getStmt().executeUpdate(seventeen3);
    
                String sixteen="DELETE FROM Posts p WHERE p.user_id =5";
                deleteRows= ex.getStmt().executeUpdate(sixteen);
                System.out.println("ë¬¸ì œ16");
                System.out.println(deleteRows+"ê°œì˜ ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
                System.out.println("-".repeat(40));
    
                ex.getStmt().close();
                ex.getConn().close();
    
            }catch(SQLException e){
                e.printStackTrace();
            }
        }
    }
    
    ```
    
    1. ë¬¸ì œ 10
        1. ê°•ì‚¬ë‹˜ì½”ë“œ
        
        ```sql
         String SQL = "UPDATE Users SET username = 'newUSer1' 
         WHERE username = 'user1'";
        statement.executeUpdate(SQL);
        ```
        
    2. ë¬¸ì œ 11
        1. ê°•ì‚¬ë‹˜ì½”ë“œ
        
        ```sql
        String SQL = 
        "INSERT INTO post_likes (user_id, post_id) VALUES " +
                        "(6, 3), (7, 3), (8, 3), (9, 3), (2, 3);";
         int count = statement.executeUpdate(SQL);
        ```
        
    3. ë¬¸ì œ 12
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
        
        ```sql
         String SQL = "UPDATE Posts SET message = " +
                        "CONCAT(message, ' - updated') " +
                        "WHERE user_id = 2";
                int count = statement.executeUpdate(SQL);
        ```
        
    4. ë¬¸ì œ 13
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
        
        ```sql
        String SQL = "UPDATE Posts SET message = " +
                        "'hello world' " +
                        "WHERE user_id = 4";
         int count = statement.executeUpdate(SQL);
        ```
        
        Postsì—ì„œ user_idë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— joiní•  í•„ìš”ê°€ ì—†ìŒ
        
    5. ë¬¸ì œ 14- ë¬¸ì œ 13ê³¼ ë™ì¼
    6. ë¬¸ì œ 15
    7. ë¬¸ì œ 16
        1. ê°•ì‚¬ë‹˜ ì½”ë“œ
            
            ```sql
            String SQL = "DELETE FROM Posts WHERE user_id = 5";
                    int count = statement.executeUpdate(SQL);
            
                    System.out.println(count);
            ```
            
        2. PreparedStatement  
        
        ```sql
             String SQL2 = 
             "SELECT p.id FROM Posts as p WHERE user_id = 5;";
        
               ResultSet rs= ex.getStmt().executeQuery(SQL2);
                 ArrayList<Integer> list = new ArrayList<>();
                 while(rs.next()){
                     list.add(rs.getInt("p.id"));
                 }
                           
             for(Integer idx: list) {
             PreparedStatement pstm;
             ex.getStmt().execute("DELETE FROM post_comments 
             WHERE post_id = " + idx);
        
             pstm = ex.getConn().prepareStatement("DELETE 
             FROM post_comments WHERE post_id = ?");
             pstm.setInt(1, idx);
             pstm.execute();
        
             pstm = ex.getConn().prepareStatement("DELETE 
             FROM post_likes WHERE post_id = ?");
             pstm.setInt(1, idx);
        
             pstm.execute();
        
        	   pstm = ex.getConn().prepareStatement("DELETE 
        	   FROM posts_hashtags WHERE post_id = ?");
             pstm.setInt(1, idx);
        
             pstm.execute();
             pstm.close();
                }
        ```
        

## ìƒˆë¡œ ì•Œê²Œ ëœ ë¶€ë¶„

### Create tableì—ì„œ ì°¸ê³ 

1. Posts tableê³¼ Post_likes, Post_comments ì˜ Created_at
    
    ![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%203.png)
    
    1. created_at ì— DATETIME ê¹Œì§€ëŠ” ê°™ìœ¼ë‚˜ DEFAULT CURRENT_TIMESTAMPë¡œ ì„¤ì •í•˜ì—¬ ìƒì„±ëœ ì‹œì ì— ì´ˆê¸°í™” ì‹œì¼œì£¼ëŠ” ì—­í• ì„ í•¨.
    2. NOW()ë¥¼ ì¨ë„ ë˜ì§€ë§Œ 8ë²„ì „ ì´í›„ì— ë‚˜ì™€ì„œ ì ìš© ì•ˆë˜ëŠ” íšŒì‚¬ë“¤ë„ ê½¤ ìˆìŒ
    3. TIMESTAMPëŠ” ë‹¤ë¥¸ ì»¬ëŸ¼ë“¤ê³¼ ë‹¤ë¥´ê²Œ NULL í—ˆìš©ì´ë¼ê³  ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ê°’ì´ NOT NULLì´ë‹¤, **TIMESTAMP NULL ì´ë¼ê³  ì§€ì •í•´ì¤˜ì•¼ NULL í—ˆìš©ë¨**
        
        ```sql
        CREATE TABLE t1 (
          ts1 TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,     -- default 0
          ts2 TIMESTAMP NULL ON UPDATE CURRENT_TIMESTAMP -- default NULL
        );
        
        CREATE TABLE t1 (
          dt1 DATETIME ON UPDATE CURRENT_TIMESTAMP,         -- default NULL
          dt2 DATETIME NOT NULL ON UPDATE CURRENT_TIMESTAMP -- default 0
        );
        ```
        

### ON DELETE CASCADE

[ON DELETE ì˜µì…˜ ì°¸ê³ í•˜ê¸°](https://www.notion.so/SQL-DDL-DML-c02e65e4b0c9410ea949bccbf3a4d325?pvs=21) - í•´ë‹¹ ë§í¬ë¡œ ì´ë™ì‹œ ON DELETE ì •ë¦¬ í•´ë†“ì€ íŒŒì¼ë¡œ ê°ˆ ìˆ˜ ìˆ

íŠ¹ì • ì‚¬ìš©ìì˜ ëª¨ë“  ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œì˜¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ì IDê°€ 5ì¸ ì‚¬ìš©ìì˜ ëª¨ë“  ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œì˜¤.

íŠ¹ì • ì‚¬ìš©ìë¥¼ ì‚­ì œí•˜ì‹œì˜¤. ì´ ë•Œ, ê´€ë ¨ëœ ëª¨ë“  ê²Œì‹œê¸€, ëŒ“ê¸€, ì¢‹ì•„ìš”, íŒ”ë¡œìš° ì •ë³´ë„ í•¨ê»˜ ì‚­ì œí•˜ì‹œì˜¤. 

ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ì IDê°€ 10ì¸ ì‚¬ìš©ìì™€ ê·¸ì˜ ê´€ë ¨ ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚­ì œí•˜ì‹œì˜¤.

ì‚¬ìš©ìIDê°€ 10ì¸ ì‚¬ìš©ìë¥¼ ì‚­ì œ ì‹œ user_idë¥¼ ì°¸ì¡°í‚¤ë¥¼ ê°€ì§€ê³  ìˆëŠ” ë‹¤ë¥¸ í…Œì´ë¸”ì—ì„œë„ ì‚­ì œê°€ ë˜ì–´ì•¼ í•˜ëŠ”ë°

í…Œì´ë¸” ë§Œë“¤ ë•Œ Restrictë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì„œ ON DELETE CASCADEë¡œ ìˆ˜ì •í•´ì•¼ í•¨.

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%204.png)

ON DELETE CASCADEë¥¼ ë„£ê³  ì‹¶ìœ¼ë©´ user_idë¥¼ ì™¸ë˜í‚¤ë¡œ ê°€ì§€ê³  ìˆëŠ” ê²ƒë“¤ì„ ë‹¤ ì‚­ì œí•˜ê³ 

ë‹¤ì‹œ ì™¸ë˜í‚¤ë¥¼ ì¶”ê°€í•´ì„œ ON DELETE CASCADEë¥¼ ë„£ì–´ì¤˜ì•¼í•¨. 

```sql
ALTER TABLE follow_follower DROP FOREIGN KEY follow_follower_ibfk_2
ALTER TABLE follow_follower ADD CONSTRAINT follow_follower_ibfk_2 FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE;
```

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%205.png)

ì™¸ë˜í‚¤ ì§€ìš¸ë•Œ ê·¸ëƒ¥ ì´ë ‡ê²Œ ì§€ìš°ë ¤ê³  í•˜ë©´ í‚¤ê°€ ì—†ë‹¤ê³  ëœ¸ , ì´ë¦„ì´ ë”°ë¡œ ìˆì–´ì„œ ê·¸ ì´ë¦„ì„ ì°¾ì•„ì£¼ì–´ì•¼ í•¨.

foreign key ì´ë¦„ ì°¾ëŠ” ì¿¼ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ë‹¤

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%206.png)

![Untitled](%5BSQL%5D%20JDBC%20%E1%84%86%E1%85%B5%E1%86%BE%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%208b32c44fa61a4799bf492a2bc02651a2/Untitled%207.png)

ì € í‚¤ë¥¼ ì§€ì›Œì•¼ í•¨. í‚¤ë¥¼ ì§€ìš°ë©´ ì™¸ë˜í‚¤ê°€ ì‚­ì œë¨.

ê·¼ë° ë§ì€ ì™œë˜í‚¤ë¥¼ ë‹¤ì‹œ ì‘ì—…í•˜ê¸° í˜ë“œë‹ˆê¹Œ

ë°ì´í„°ë² ì´ìŠ¤ ë‹¤ ì§€ìš´ë’¤ì— Create table ë•Œ ì™¸ë˜í‚¤ ì¶”ê°€ì‹œì— ON DELETE CASCADEë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

í…Œì´ë¸” ì„¤ê³„ì‹œ ì´ë¶€ë¶„ì€ ë¯¸ë¦¬ ê³ ë¯¼í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

### PreparedStatement

ë¬¸ì œ17ë²ˆ

```sql
     String SQL2 = 
     "SELECT p.id FROM Posts as p WHERE user_id = 5;";

       ResultSet rs= ex.getStmt().executeQuery(SQL2);
         ArrayList<Integer> list = new ArrayList<>();
         while(rs.next()){
             list.add(rs.getInt("p.id"));
         }
                   
     for(Integer idx: list) {
     PreparedStatement pstm;
     ex.getStmt().execute("DELETE FROM post_comments 
     WHERE post_id = " + idx);

     pstm = ex.getConn().prepareStatement("DELETE 
     FROM post_comments WHERE post_id = ?");
     pstm.setInt(1, idx);
     pstm.execute();

     pstm = ex.getConn().prepareStatement("DELETE 
     FROM post_likes WHERE post_id = ?");
     pstm.setInt(1, idx);

     pstm.execute();

	   pstm = ex.getConn().prepareStatement("DELETE 
	   FROM posts_hashtags WHERE post_id = ?");
     pstm.setInt(1, idx);

     pstm.execute();
     pstm.close();
        }
```

 PreparedStatement pstm; ë¥¼ ì„ ì–¸ í›„

```sql
  pstm = ex.getConn().prepareStatement("DELETE 
     FROM post_comments WHERE post_id = ?");
     pstm.setInt(1, idx);
     pstm.execute();
```

 ptsmì„ ì´ˆê¸°í™” í•´ì£¼ëŠ”ë° í•´ë‹¹ ë¬¸ì¥ì˜ â€˜? â€˜ê°€ ì¸ìê°€ ë“¤ì–´ê°€ëŠ” ê³³ì´ë‹¤.

ptsm.setInt(1,idx)ëŠ” ì²«ë²ˆì§¸ ì¸ìì— idxë¼ëŠ” ê°’ì´ ë“¤ì–´ê°„ë‹¤ëŠ” í‘œì‹œì´ë©° â€˜?â€™ ê°€ í•œê°œë°–ì— ì—†ìœ¼ë¯€ë¡œ 1ë°–ì— ì˜¬ ìˆ˜ ì—†ë‹¤.

ë§Œì•½ ì¸ìê°€ ì—¬ëŸ¬ê°œë¼ë©´? ì´ëŸ°ì‹ìœ¼ë¡œ ì…ë ¥ê°€ëŠ¥

```sql
PreparedStatement ptsm
ptsm = ex.getConn().prepareStatement("insert into Users (username,password,post_id)Values(?,?,?)");
ptsm.setString(1,'jerry');
ptsm.setString(2,'jerryIsSoCute');
ptsm.setInt(3,1);

int result = ptsm.executeUpdate();
``` -->