---
layout : single
title : "[SQL] Practice 3"
categories: Database
tag : [DBMS, SQL, ì‹¤ìŠµ]
author_profile: true
---

ğŸ“Œ ê°œì¸ì ì¸ ê³µê°„ìœ¼ë¡œ ê³µë¶€ë¥¼ ê¸°ë¡í•˜ê³  ë³µìŠµí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. <br>
ì •í™•í•˜ì§€ ì•Šì€ ì •ë³´ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ì°¸ê³ ë°”ëë‹ˆë‹¤ :ğŸ˜¸ <br>
[í‹€ë¦° ë‚´ìš©ì€ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì‹œë©´ ë³µë°›ìœ¼ì‹¤ê±°ì—ìš”]  
{: .notice--primary}


### sql - ì¶”ê°€ë¡œ ì•Œê²Œ ëœ ê²ƒ

- DATETIME ì‹œë¶„ì´ˆê¹Œì§€ ë‚˜ì˜´.
- TEXT ì¤„ë„˜ê¹€ ê°€ëŠ¥, ê¸¸ì´ì œí•œ ì—†ìŒ
- Between A and B ì˜ ê²½ìš°  BëŠ” í¬í•¨ë˜ì§€ ì•ŠìŒ.
- âœ¨coalesce( ì™¼ìª½, ì˜¤ë¥¸ìª½) â‡’ coalesceëŠ” nullì´ ì•„ë‹ ë•ŒëŠ” ì™¼ìª½, nullì¼ ë•ŒëŠ” ì˜¤ë¥¸ìª½ ê°’ì„ ë°˜í™˜í•¨.

# ë ˆìŠ¤í† ë‘ ì˜ˆì•½ì‹œìŠ¤í…œ

<img src="https://github.com/user-attachments/assets/d1ae570a-985e-4397-a1ef-2c9b8afab2e9" width=400/>

### ë¬¸ì œ - ê³ ê¸‰2

1. **ë¬¸ì œ** 
    
    íŠ¹ì • ê¸°ê°„ ë™ì•ˆì˜ ì´ ì˜ˆì•½ ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”. (ì˜ˆ: 2024ë…„ 5ì›” 1ì¼ë¶€í„° 5ì›” 31ì¼ê¹Œì§€) 
    
2. ë‚˜ì˜ ì¿¼ë¦¬
    
    ```sql
    SELECT COUNT(r.reservation_id) 
    from reservations r
    where r.reservation_time
    BETWEEN '2024-05-01' AND '2024-05-31';
    ```
    
    Between A and B ì˜ ê²½ìš°  BëŠ” í¬í•¨ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ BETWEEN '2024-05-01' AND '2024-06-01' ë¡œ ë³€ê²½í•´ì•¼í•¨.
    

### ë¬¸ì œ - ê³ ê¸‰4

1. ë¬¸ì œ
    
    íŠ¹ì • ê³ ê°(ì˜ˆ: ê³ ê° IDê°€ 3)ì˜ ì´ ì£¼ë¬¸ ê¸ˆì•¡ì„ ê³„ì‚°í•˜ì„¸ìš”.
    
2. ë‚˜ì˜ ì¿¼ë¦¬
    
    ```sql
    select c.name,sum(m.price*o2.quantity)
    from customers c 
    join reservations r 
    on r.customer_id =c.customer_id 
    join orders o 
    on r.reservation_id =o.order_id 
    join orderdetails o2 
    on o2.order_id = o.order_id 
    join menuitems m 
    on m.menu_item_id =o2.menu_item_id 
    where c.customer_id =3
    group by c.name ;
    ```
    
    ì´ ì£¼ë¬¸ ê¸ˆì•¡ë§Œ ê³„ì‚°í•˜ë©´ ë˜ë¯€ë¡œ êµ³ì´ customer ê¹Œì§€ join í•  í•„ìš” ì—†ì´ reservationì— customer_idê°€ ìˆì–´ì„œ reservationê¹Œì§€ ì¡°ì¸í•˜ë©´ ë¨.
    
    <img src="https://github.com/user-attachments/assets/ac78d476-36df-4a60-88d9-8786b420b988" width=200/>
    
3. Reference
    
    ```sql
    select sum(mi.price * od.quantity) as total_spend 
    from orders o 
    join orderdetails od
    on od.order_id = o.order_id 
    join menuitems mi
    on mi.menu_item_id = od.menu_item_id 
    where o.reservation_id in (select r.reservation_id from reservations r 
    where r.customer_id = 3);
    ```
    
    ë§ˆì§€ë§‰ join ëŒ€ì‹ ì— whereì ˆì—ì„œ ì„œë¸Œì¿¼ë¦¬ë¡œ ì¡°ê±´ ê±¸ì–´ì„œ í’€ ìˆ˜ ìˆìŒ, ê²°ê³¼ëŠ” ë‚˜ì™€ ë™ì¼í•˜ê²Œ ë‚˜ì˜¨ë‹¤!
    
   <img src="https://github.com/user-attachments/assets/a7e99e95-217d-4c70-9d65-b8e84a1c7341" width=300/>
    

### ë¬¸ì œ - ê³ ê¸‰7 , í‹€ë¦¼ âš¡

1. ë¬¸ì œ
    
    ëª¨ë“  ì£¼ë¬¸ì—ì„œ ê°€ì¥ ë§ì´ ì£¼ë¬¸ëœ ë©”ë‰´ ì•„ì´í…œì˜ ì´ë¦„ê³¼ ì´ ì£¼ë¬¸ ìˆ˜ëŸ‰ì„ ì¡°íšŒí•˜ì„¸ìš”.
    
2. ë‚˜ì˜ ì¿¼ë¦¬
    
    ```sql
    select m.name, sum(o.quantity)  
    from menuitems m
    join orderdetails o
    on o.menu_item_id = m.menu_item_id 
    where o.quantity in (select max(o.menu_item_id) 
    					from orderdetails o2)
    group by o.menu_item_id ;
    ```
    
    ì¤‘ë³µ ìµœëŒ€ê°’ì€ ì¡°íšŒëª»í•˜ê¸°ë•Œë¬¸ì— ì„œë¸Œì¿¼ë¦¬ ì‚¬ìš©í•´ì•¼í•¨
    
    â†’í’€ì´ ì¤‘ì— ë‹¤ì‹œ ë³´ë‹ˆ maxê°’ì˜ ê¸°ì¤€ì´ ì˜ëª»ë˜ì–´ ìˆì–´ì„œ ì•„ë˜ì™€ ê°™ì´ ì¿¼ë¦¬ë¬¸ì„ ìˆ˜ì •í–ˆë‹¤.
    
    ```sql
    select m.name, sum(od.quantity)as total_order
    from menuitems m
    join orderdetails od
    on od.menu_item_id = m.menu_item_id 
    where od.quantity in (select max(o2.quantity) 
    					from orderdetails o2)
    group by od.menu_item_id ;
    ```
    
    <img src="https://github.com/user-attachments/assets/229b339a-7ef7-4b99-ab4b-9e42a90e0bbc" width=300/>
    

1. Reference
    
    ```sql
    select m.name,sum(od.quantity)as total_order from menuitems m
    join orderdetails od on od.menu_item_id = m.menu_item_id 
    group by m.name
    having total_order = (select max(qt) from (select sum(od2.quantity) as qt 
    						from orderdetails od2
    						group by menu_item_id)as subquery);
    ```
    
    ì‹¤í–‰ê²°ê³¼ëŠ” ìˆ˜ì •í•œ í’€ì´ì™€ ë™ì¼í•˜ë‹¤.
    

### ë¬¸ì œ - ê³ ê¸‰9 (ì•„ìš°í„° ì¡°ì¸ ì•ˆí•´ì„œ í‹€ë¦¼)

1. ë¬¸ì œ
    
    ê° ê³ ê°ë³„ë¡œ ëª¨ë“  ì£¼ë¬¸ì— ëŒ€í•œ í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡ì„ ê³„ì‚°í•˜ì„¸ìš”.
    
2. ë‚˜ì˜ ì¿¼ë¦¬
    
    ```sql
    select c.name, avg(mi.price*od.quantity) 
    from customers c 
    left join reservations r 
    on c.customer_id = r.customer_id 
    left join orders o 
    on r.reservation_id = o.reservation_id 
    left join orderdetails od
    on od.order_id = o.order_id
    left join menuitems mi 
    on mi.menu_item_id =od.menu_item_id 
    group by c.name;
    ```
    
    ê³ ê°ì´  null ê°’ì„ ê°€ì§ˆ ë•Œë„ ê²°ê³¼ê°€ ë‚˜ì™€ì•¼í•˜ë¯€ë¡œ ì•„ìš°í„° ì¡°ì¸ ì‚¬ìš©í•´ì•¼ í•¨.
    
     â†’ ì•„ìš°í„° ì¡°ì¸ ì‚¬ìš©ì‹œ  null ê°’ ë°œìƒ
    
    <img src="https://github.com/user-attachments/assets/d77a7282-ed78-45eb-8a1e-adb20fdd8024" width=200/>
    
3. Reference
    
    ```sql
    select c.name, coalesce(avg(mi.price * od.quantity), 0) 
    from customers c 
    left join reservations as r
    on r.customer_id = c.customer_id 
    left join orders o 
    on o.reservation_id = r.reservation_id 
    left join orderdetails as od
    on od.order_id = o.order_id 
    left join menuitems as mi
    on mi.menu_item_id = od.menu_item_id
    group by c.name;
    ```
    
    coalesceì‚¬ìš©í•´ì„œ ê°’ ë³€ê²½ ê°€ëŠ¥.
    
    âœ¨coalesce( ì™¼ìª½, ì˜¤ë¥¸ìª½) : coalesceëŠ” nullì´ ì•„ë‹ ë•ŒëŠ” ì™¼ìª½, nullì¼ ë•ŒëŠ” ì˜¤ë¥¸ìª½ ê°’ì„ ë°˜í™˜í•¨.